<!-- Shared shell: header, sidebar, aside, footer -->
<!-- 模块：全站壳层 / Shared shell (header, sidebar, footer). 保留导航与动画。 -->
<header>
    <h1>
        <button class="sidebar-collapse-btn header-collapse-btn" aria-controls="sidebar" aria-expanded="true" title="折叠/展开侧边栏">
            <i class="icon-ic_fluent_list_24_regular item-icon" aria-hidden="true"></i>
        </button>
        <span class="header-title">
            <a href="/" title="水鱼 Blog">
                <img src="/resource/img/shell/favicon.ico" alt="logo" class="logo" fetchpriority="high">
                <span class="title-text">水鱼 Blog</span>
            </a>
            <span id="page-loading-indicator" class="page-loading-indicator" aria-hidden="true"></span>
        </span>
        <div class="header-actions">
        <button class="header-search-btn" id="header-search-btn" aria-label="搜索" title="搜索">
            <i class="icon-ic_fluent_search_24_regular" aria-hidden="true"></i>
        </button>
        <button class="theme-toggle-btn" aria-label="切换深色/浅色模式" title="切换深色/浅色模式">
            <i class="fluent-font" aria-hidden="true">&#xF87E;</i>
        </button>
        <div class="theme-settings-container">
            <button class="theme-settings-btn" aria-label="设置" title="设置">
                <i class="fluent-font" aria-hidden="true">&#xF6AA;</i>
            </button>
        </div>
        <img src="/resource/img/shell/shuiyu.avif" alt="shuiyu" class="header-avatar" id="avatar-btn" fetchpriority="high">
    </h1>
</header>
<nav id="sidebar" class="sidebar" aria-label="主导航">
    <ul>
        <li>
            <a href="/">
                <i class="icon-ic_fluent_home_24_regular item-icon" aria-hidden="true"></i>
                <span class="label">主页</span>
            </a>
        </li>
        <li class="has-children">
            <button class="toggle" aria-expanded="false">
                <i class="icon-ic_fluent_code_24_regular item-icon" aria-hidden="true"></i>
                <span class="toggle-label">项目</span>
                <span class="toggle-icon fluent-font" aria-hidden="true">&#xF2B1;</span>
            </button>
            <ul class="submenu">
                <li>
                    <a href="/projects/modrinth.html">
                        <i class="icon-ic_fluent_cube_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">Modrinth</span>
                    </a>
                </li>
                <li>
                    <a href="/projects/better-crafting-recipes.html">
                        <i class="icon-ic_fluent_table_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">更好的合成配方</span>
                    </a>
                </li>
                <li>
                    <a href="/projects/better-enchantments.html">
                        <i class="icon-ic_fluent_wand_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">更好附魔</span>
                    </a>
                </li>
                <li>
                    <a href="/projects/better-mob-drop.html">
                        <i class="icon-ic_fluent_cube_multiple_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">更好的生物掉落</span>
                    </a>
                </li>
                <li>
                    <a href="/projects/magical-dye.html">
                        <i class="icon-ic_fluent_color_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">魔法染料</span>
                    </a>
                </li>
                <li>
                    <a href="/projects/github.html">
                        <i class="icon-ic_fluent_animal_cat_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">Github</span>
                    </a>
                </li>
            </ul>
        </li>
        <li class="has-children">
            <button class="toggle" aria-expanded="false">
                <i class="icon-ic_fluent_toolbox_24_regular item-icon" aria-hidden="true"></i>
                <span class="toggle-label">工具</span>
                <span class="toggle-icon fluent-font" aria-hidden="true">&#xF2B1;</span>
            </button>
            <ul class="submenu">
                <li>
                    <a href="/tool/base64.html">
                        <i class="icon-ic_fluent_code_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">Base64 编解码</span>
                    </a>
                </li>
            </ul>
        </li>
        <li class="has-children">
            <button class="toggle" aria-expanded="false">
                <i class="icon-ic_fluent_apps_list_24_regular item-icon" aria-hidden="true"></i>
                <span class="toggle-label">专栏</span>
                <span class="toggle-icon fluent-font" aria-hidden="true">&#xF2B1;</span>
            </button>
            <ul class="submenu">
                <li>
                    <a href="/column/comments.html">
                        <i class="icon-ic_fluent_comment_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">留言板</span>
                    </a>
                </li>
            </ul>
        </li>
        <li class="has-children">
            <button class="toggle" aria-expanded="false">
                <i class="icon-ic_fluent_movies_and_tv_24_regular item-icon" aria-hidden="true"></i>
                <span class="toggle-label">视频存档</span>
                <span class="toggle-icon fluent-font" aria-hidden="true">&#xF2B1;</span>
            </button>
            <ul class="submenu">
                <li>
                    <a href="/video-archive/list-bilivideo.html">
                        <i class="icon-ic_fluent_tv_24_regular item-icon" aria-hidden="true"></i>
                        <span class="label">哔哩哔哩</span>
                    </a>
                </li>
            </ul>
        </li>
        <li>
            <a href="/about.html">
                    <i class="icon-ic_fluent_info_24_regular item-icon" aria-hidden="true"></i>
                    <span class="label">关于</span>
            </a>
        </li>
    </ul>
</nav>
<button id="scroll-to-top" class="scroll-to-top" aria-label="返回顶部" title="返回顶部" data-state="top">
    <i class="scroll-to-top-icon icon-ic_fluent_arrow_up_24_regular item-icon" aria-hidden="true"></i>
</button>
<footer>
    <p>2022-2026 滄海水魚</p>
    <p>当前版本：<strong>2.0.3.3-20260218</strong></p>
</footer>
<div id="global-copy-toast" class="global-copy-toast" role="status" aria-live="assertive">
    <span class="global-toast-icon fluent-icon icon-ic_fluent_checkmark_circle_24_regular" aria-hidden="true"></span>
    <span class="global-toast-message"></span>
    <button type="button" class="global-toast-close" aria-label="关闭提示">×</button>
</div>
<!-- 分步加载 & 轻量懒加载库 -->
<script src="/js/copy-toast.js" defer></script>
<script>
// 首先加载 lazysizes（用于图片/iframe 等懒加载），然后按需动态导入交互脚本
(function(){
    // 插入 lazysizes 脚本（CDN 小脚本，未阻塞渲染）
    var s = document.createElement('script');
    s.src = 'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js';
    s.async = true;
    document.head.appendChild(s);

    // 当主交互首次需要时再加载模块（通过事件触发）
    function loadInteractionModules(){
        if(window._interactionLoaded) return;
        window._interactionLoaded = true;
        // 使用动态 import 分步加载局部脚本（如果浏览器支持）
        if('noModule' in HTMLScriptElement.prototype){
            // 先加载 avatar-loader（模块），并调用初始化
            import('/js/avatar-loader.js').then(function(m){ try{ m.initAvatarLoader && m.initAvatarLoader(); }catch(e){} }).catch(()=>{});
            import('/js/avatar.js').catch(()=>{});
            import('/js/theme.js').catch(()=>{});
            import('/js/sidebar.js').catch(()=>{});
            import('/js/scroll-to-top.js').catch(()=>{});
            import('/js/settings-modal.js').catch(()=>{});
        } else {
            // 回退：按需创建 script 标签
            var toLoad = ['/js/image-loader.nomodule.js','/js/avatar.js','/js/theme.js','/js/sidebar.js','/js/scroll-to-top.js','/js/settings-modal.js'];
            toLoad.forEach(function(p){
                var sc = document.createElement('script');
                sc.src = p;
                sc.async = true;
                document.body.appendChild(sc);
            });
        }
    }

    // 在用户交互（移动鼠标、按键、触屏）时加载交互脚本
    var events = ['mousemove','touchstart','keydown','click'];
    var evHandler = function(){ loadInteractionModules(); events.forEach(function(e){ window.removeEventListener(e, evHandler); }); };
    events.forEach(function(e){ window.addEventListener(e, evHandler, {passive:true}); });

    // 2 秒后作为降级加载（用户可能未交互）
    setTimeout(loadInteractionModules, 2000);
})();
</script>