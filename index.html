<!DOCTYPE html>
<!-- 模块：站点首页 / Home page entry. 保留主导航、路由与动画效果。 -->
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>主页</title>

    <meta name="author" content="whwdzg">
    <meta name="description" content="whwdzg's personal page">
    <meta name="theme-color" content="#ffffff">

    <link rel="manifest" href="/manifest.json">

    <link rel="icon" href="img/shell/favicon.ico" type="image/x-icon">
    
    <!-- 预加载关键资源：优先级从高到低 -->
    <!-- 1. 页眉图片（最高优先级） -->
    <link rel="preload" href="img/shell/favicon.ico" as="image" type="image/x-icon">
    <link rel="preload" href="img/shell/shuiyu.avif" as="image" type="image/avif">
    <!-- 2. 背景图片 -->
    <link rel="preload" href="img/shell/bg.jpg" as="image" type="image/jpeg">
    <!-- 3. 关键CSS -->
    <link rel="preload" href="css/variables.css" as="style">
    <link rel="preload" href="font/FluentSystemIcons-Regular.woff2" as="font" type="font/woff2" crossorigin>
    
    <!-- CSS 模块 -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/input.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/main-content.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/lightbox.css">
    <link rel="stylesheet" href="css/settings-modal.css">
    <link rel="stylesheet" href="css/scroll-to-top.css">
    <link rel="stylesheet" href="font/FluentSystemIcons-Regular.css">
    <!-- JavaScript 模块 -->
    <script src="/js/pwa/register-sw.js" defer></script>
    <script src="js/i18n-loader.js" defer></script>
    <script src="js/theme.js" defer></script>
    <script src="js/language.js" defer></script>
    <script src="js/sidebar.js" defer></script>
    <script src="js/lightbox.js" defer></script>
    <script src="js/avatar.js" defer></script>
    <script src="js/scroll-to-top.js" defer></script>
    <script src="js/search.js" defer></script>
    <script src="js/spa-router.js" defer></script>
        <script src="js/settings-modal.js" defer></script>
</head>
<body>
    <!-- shell placeholder: will be populated from includes/shell.html -->
    <div id="shell-root"></div>
         <script>
            (function(){
                var container = document.getElementById('shell-root');
                function normalize(pathname) {
                    var p = pathname.replace(/\/index\.html$/i, '/').replace(/\.html$/i, '').replace(/\/+$/, '');
                    return p === '' ? '/' : p;
                }
                function markCurrentNav() {
                    var current = normalize(location.pathname);
                    document.querySelectorAll('#sidebar a[href]').forEach(function(a){
                        var href = a.getAttribute('href');
                        if (!href) return;
                        var target = normalize(new URL(href, location.origin).pathname);
                        if (target === current) {
                            a.classList.add('current','selected');
                            var parent = a.closest('.has-children');
                            if (parent) {
                                parent.classList.add('open');
                                var toggle = parent.querySelector('.toggle');
                                var submenu = parent.querySelector('.submenu');
                                if (toggle) toggle.setAttribute('aria-expanded','true');
                                if (submenu) submenu.style.maxHeight = submenu.scrollHeight + 'px';
                            }
                        }
                    });
                }
                function attachShell(html) {
                    if (!container || !html) return;
                    container.innerHTML = html;
                    var move = function() {
                        var main = document.querySelector('main');
                        if (!main) return;
                        var aside = container.querySelector('aside');
                        var footer = container.querySelector('footer');
                        if (aside && !main.contains(aside)) {
                            aside.setAttribute('data-shell-moved', '1');
                            main.appendChild(aside);
                        }
                        if (footer && footer.parentNode !== main.parentNode) {
                            footer.setAttribute('data-shell-moved', '1');
                            main.insertAdjacentElement('afterend', footer);
                        }
                        if (window.refreshAsideStack) {
                            window.refreshAsideStack();
                        }
                        markCurrentNav();
                    };
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', move, { once: true });
                    } else {
                        move();
                    }
                }
                function bust(url){
                    if (location.protocol === 'file:') return url;
                    var sep = url.indexOf('?') === -1 ? '?' : '&';
                    return url + sep + 'ts=' + Date.now();
                }
                try {
                    var xhr = new XMLHttpRequest();
                    xhr.open('GET', bust('/includes/shell.html'), false);
                    xhr.send(null);
                    if (xhr.status === 200 || xhr.status === 0) {
                        attachShell(xhr.responseText);
                        return;
                    }
                } catch (e) {}
                fetch(bust('/includes/shell.html'), { cache: 'no-store' })
                    .then(function(resp){ return resp.ok ? resp.text() : Promise.reject(new Error('HTTP '+resp.status)); })
                    .then(function(html){ attachShell(html); });
            })();
        </script>
    <main>
        <!--主体-->
        <section id="home">
            <h2>主页</h2>
            <p>这里是2.0版本的主页，当前正在构建中，尚处于<strong>极早期阶段</strong>，供实验学习使用</p>
        </section>
        <section id="test">
            <h2>test</h2>
            <p>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
                1<br>
            </p>
            <!--img插入图片后，不添加<br>换行时，直接加<p>视作图片标题，正文不显示，只在查看大图时显示-->
            <img src="img/shell/shuiyu.avif" loading="lazy" fetchpriority="low"><p>head</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg2</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <video src="vid/[P01]1 羊皮伪装.mp4" controls preload="metadata" loading="lazy" fetchpriority="low"></video><p>sample video</p><br>
            <img src="img/shell/bg.jpg" loading="lazy" fetchpriority="low"><p>bg</p><br>
            <p>结束</p>
        </section>
    </main>
</body>

</html>